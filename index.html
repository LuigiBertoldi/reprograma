<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Reprograma 30 ‚Äî M√©todo Anti-V√≠cio</title>
  <meta name="description" content="Reprograma 30: m√©todo anti-v√≠cio com trilhas para apostas, √°lcool, fumar, pornografia e drogas. Check-in, modo crise e recompensas." />
  <meta name="theme-color" content="#070b14" />

  <style>
    :root{
      --bg:#070b14;
      --bg-soft:#0b1120;
      --panel:rgba(255,255,255,.03);
      --panel-2:rgba(255,255,255,.045);
      --line:rgba(255,255,255,.08);
      --line-2:rgba(255,255,255,.14);
      --text:#eef3ff;
      --muted:#aab4cf;

      --violet:#8c5bff;
      --cyan:#35d3ff;
      --pink:#ff59d8;

      --good:#35d07f;
      --warn:#ffcc66;
      --bad:#ff637d;

      --shadow:0 24px 80px rgba(0,0,0,.42);
      --shadow-soft:0 10px 35px rgba(0,0,0,.25);

      --r-sm:14px;
      --r:20px;
      --r-lg:28px;

      --max:1120px;
      --nav-h:72px;
    }

    *{box-sizing:border-box}
    html,body{margin:0;padding:0}
    html{scroll-behavior:smooth}
    body{
      font-family: Inter, ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
      color:var(--text);
      background:
        radial-gradient(900px 600px at 10% -10%, rgba(140,91,255,.18), transparent 60%),
        radial-gradient(800px 520px at 100% 0%, rgba(53,211,255,.12), transparent 60%),
        linear-gradient(180deg, #070b14, #0a1020 70%, #0a1121);
      min-height:100vh;
      overflow-x:hidden;
    }

    a{color:inherit;text-decoration:none}
    button, input, select{font:inherit}
    .wrap{max-width:var(--max);margin:0 auto;padding:0 20px}
    .hidden{display:none!important}

    /* ============ NAV ============ */
    .nav{
      position:sticky;top:0;z-index:50;
      height:var(--nav-h);
      backdrop-filter: blur(10px);
      background:rgba(7,11,20,.72);
      border-bottom:1px solid var(--line);
    }
    .nav-inner{
      height:100%;
      display:flex;align-items:center;justify-content:space-between;gap:14px;
    }

    .brand{
      display:flex;align-items:center;gap:12px;
      min-width:220px;
      cursor:pointer;
    }
    .brand-mark{
      width:40px;height:40px;border-radius:14px;
      display:grid;place-items:center;
      border:1px solid var(--line);
      background:rgba(255,255,255,.02);
      box-shadow:0 10px 25px rgba(140,91,255,.12);
      overflow:hidden;
      flex:0 0 auto;
    }
    .brand-text .title{
      display:flex;align-items:center;gap:6px;
      font-weight:900;letter-spacing:.1px;font-size:15px;line-height:1;
    }
    .brand-text .title .num{
      background:linear-gradient(135deg,var(--violet),var(--cyan));
      -webkit-background-clip:text;
      background-clip:text;
      color:transparent;
    }
    .brand-text .sub{
      margin-top:3px;
      font-size:11px;color:var(--muted)
    }

    .nav-links{
      display:flex;align-items:center;gap:8px;flex-wrap:wrap;
    }
    .nav-links a{
      font-size:13px;color:var(--muted);
      border:1px solid transparent;
      padding:8px 10px;border-radius:999px;
      transition:.16s ease;
    }
    .nav-links a:hover{
      color:var(--text);
      background:rgba(255,255,255,.03);
      border-color:var(--line);
    }

    .nav-actions{
      display:flex;align-items:center;gap:10px;
      flex:0 0 auto;
    }

    /* ============ BUTTONS ============ */
    .btn{
      display:inline-flex;align-items:center;justify-content:center;gap:8px;
      border-radius:999px;border:1px solid transparent;
      padding:11px 14px;
      font-weight:800;font-size:14px;
      cursor:pointer;
      transition:.15s ease;
      user-select:none;
      white-space:nowrap;
    }
    .btn:hover{transform:translateY(-1px)}
    .btn:active{transform:translateY(0)}
    .btn-sm{padding:9px 12px;font-size:13px}
    .btn-block{width:100%}

    .btn-primary{
      color:#06101b;
      background:linear-gradient(135deg,var(--violet),var(--cyan));
      box-shadow:0 12px 30px rgba(53,211,255,.15),0 12px 30px rgba(140,91,255,.18);
    }
    .btn-ghost{
      color:var(--text);
      border-color:var(--line);
      background:rgba(255,255,255,.02);
    }
    .btn-soft{
      color:var(--text);
      border-color:rgba(255,255,255,.10);
      background:rgba(255,255,255,.05);
    }

    /* ============ SECTIONS ============ */
    section{padding:30px 0}
    .section-head{
      display:flex;align-items:flex-end;justify-content:space-between;gap:14px;
      margin-bottom:14px;
    }
    .section-head h2{
      margin:0;
      font-size:22px;
      letter-spacing:-.3px;
    }
    .section-head p{
      margin:0;
      color:var(--muted);
      font-size:13px;
      line-height:1.55;
      max-width:700px;
      text-align:right;
    }

    /* ============ HERO ============ */
    header{padding:34px 0 10px}
    .hero{
      position:relative;
      border:1px solid var(--line);
      background:linear-gradient(180deg, rgba(255,255,255,.04), rgba(255,255,255,.02));
      border-radius:var(--r-lg);
      box-shadow:var(--shadow);
      overflow:hidden;
      padding:26px;
      isolation:isolate;
    }
    .hero::before{
      content:"";
      position:absolute;
      width:340px;height:340px;border-radius:50%;
      right:-120px;top:-140px;
      background:radial-gradient(circle, rgba(53,211,255,.22), transparent 60%);
      filter:blur(8px);
      z-index:-1;
    }
    .hero::after{
      content:"";
      position:absolute;
      width:420px;height:420px;border-radius:50%;
      left:-160px;bottom:-220px;
      background:radial-gradient(circle, rgba(140,91,255,.20), rgba(255,89,216,.08), transparent 62%);
      filter:blur(10px);
      z-index:-1;
    }

    .hero-grid{
      display:grid;
      grid-template-columns:1.1fr .9fr;
      gap:20px;
      align-items:start;
    }

    .hero-kicker{
      display:flex;flex-wrap:wrap;gap:8px;
      margin-bottom:12px;
    }
    .pill{
      display:inline-flex;align-items:center;gap:8px;
      border:1px solid var(--line);
      background:rgba(255,255,255,.02);
      color:var(--muted);
      padding:6px 10px;
      border-radius:999px;
      font-size:12px;
    }
    .dot{
      width:8px;height:8px;border-radius:50%;
      background:var(--good);
      box-shadow:0 0 0 4px rgba(53,208,127,.12);
    }

    .hero h1{
      margin:0 0 10px;
      font-size:42px;
      line-height:1.03;
      letter-spacing:-1px;
      max-width:14ch;
    }
    .hero .lead{
      margin:0;
      color:var(--muted);
      line-height:1.65;
      font-size:15px;
      max-width:62ch;
    }
    .hero .cta{
      display:flex;gap:10px;flex-wrap:wrap;
      margin-top:16px;
    }
    .hero .warn{
      margin-top:14px;
      color:#ffd6df;
      font-size:12px;line-height:1.55;
      border-top:1px solid var(--line);
      padding-top:12px;
    }

    .hero-side{
      display:grid;gap:10px;
    }
    .mini-card{
      border:1px solid var(--line);
      background:rgba(255,255,255,.02);
      border-radius:18px;
      padding:14px;
    }
    .mini-card h3{
      margin:0 0 7px;
      font-size:14px;
      letter-spacing:-.2px;
    }
    .mini-card p{
      margin:0;color:var(--muted);
      font-size:13px;line-height:1.55;
    }

    .mini-list{
      display:grid;gap:8px;
    }
    .mini-list .item{
      display:flex;gap:10px;align-items:flex-start;
      padding:10px 12px;
      border-radius:14px;
      border:1px solid var(--line);
      background:rgba(255,255,255,.015);
    }
    .spark{
      width:9px;height:9px;border-radius:50%;
      margin-top:5px;
      background:linear-gradient(135deg,var(--pink),var(--violet),var(--cyan));
      box-shadow:0 0 0 5px rgba(140,91,255,.10);
      flex:0 0 auto;
    }
    .mini-list b{font-size:13px}
    .mini-list span{display:block;color:var(--muted);font-size:12px;line-height:1.45}

    /* ============ GRID / CARDS ============ */
    .grid{display:grid;gap:12px}
    .grid-2{grid-template-columns:repeat(2,minmax(0,1fr))}
    .grid-3{grid-template-columns:repeat(3,minmax(0,1fr))}

    .card{
      border:1px solid var(--line);
      background:var(--panel);
      border-radius:var(--r);
      padding:16px;
      box-shadow:var(--shadow-soft);
    }
    .card h3{
      margin:0 0 7px;
      font-size:15px;
      letter-spacing:-.15px;
    }
    .card p{
      margin:0;color:var(--muted);
      line-height:1.58;
      font-size:13px;
    }

    .divider{
      height:1px;background:var(--line);
      margin:12px 0;
    }

    .badge{
      display:inline-block;
      border-radius:999px;
      padding:6px 9px;
      font-size:11px;
      border:1px solid var(--line);
      background:rgba(255,255,255,.02);
      color:var(--muted);
      margin:3px 6px 0 0;
    }
    .badge.good{border-color:rgba(53,208,127,.25); color:#baf0d3; background:rgba(53,208,127,.08)}
    .badge.warn{border-color:rgba(255,204,102,.25); color:#ffe3ae; background:rgba(255,204,102,.07)}
    .badge.bad{border-color:rgba(255,99,125,.25); color:#ffd0d8; background:rgba(255,99,125,.07)}

    /* ============ IDENTIFY CARDS ============ */
    .choice{
      display:flex;justify-content:space-between;align-items:flex-start;gap:10px;
      cursor:pointer;
      transition:.16s ease;
    }
    .choice:hover{
      transform:translateY(-2px);
      border-color:rgba(53,211,255,.24);
      background:rgba(255,255,255,.045);
    }
    .choice-right{
      display:flex;align-items:center;justify-content:center;
      min-width:54px;
    }

    /* ============ PRICING ============ */
    .pricing{display:grid;grid-template-columns:1fr 1fr;gap:12px}
    .price{
      position:relative;
      overflow:hidden;
    }
    .price.best{
      border-color:rgba(53,211,255,.28);
      background:linear-gradient(180deg, rgba(53,211,255,.05), rgba(255,255,255,.03));
    }
    .ribbon{
      position:absolute;top:10px;right:10px;
      font-size:10px;font-weight:800;
      color:#06101b;
      background:linear-gradient(135deg,var(--violet),var(--cyan));
      border-radius:999px;
      padding:6px 8px;
    }
    .price .money{
      margin:8px 0 2px;
      font-size:34px;
      line-height:1;
      font-weight:900;
      letter-spacing:-.8px;
    }
    .price .money small{
      font-size:13px;font-weight:700;color:var(--muted)
    }

    .features{
      list-style:none;padding:0;margin:12px 0 0;
      display:grid;gap:8px;
    }
    .features li{
      display:flex;gap:10px;align-items:flex-start;
      color:var(--muted);font-size:13px;line-height:1.45;
    }
    .check{
      width:18px;height:18px;border-radius:7px;
      border:1px solid rgba(53,208,127,.25);
      background:rgba(53,208,127,.08);
      color:var(--good);
      display:grid;place-items:center;
      font-weight:900;
      margin-top:1px;
      flex:0 0 auto;
    }

    /* ============ FAQ (accordion correto) ============ */
    .faq-list{display:grid;gap:10px}
    .faq-item{
      border:1px solid var(--line);
      background:rgba(255,255,255,.025);
      border-radius:16px;
      overflow:hidden;
    }
    .faq-btn{
      width:100%;
      background:transparent;
      color:var(--text);
      border:none;
      cursor:pointer;
      display:flex;justify-content:space-between;align-items:center;gap:12px;
      padding:14px 16px;
      text-align:left;
      font-weight:800;
      font-size:14px;
    }
    .faq-btn:hover{background:rgba(255,255,255,.02)}
    .faq-icon{
      width:28px;height:28px;border-radius:10px;
      border:1px solid var(--line);
      display:grid;place-items:center;
      color:var(--muted);
      flex:0 0 auto;
      font-weight:900;
    }
    .faq-panel{
      padding:0 16px 14px;
      color:var(--muted);
      font-size:13px;
      line-height:1.6;
      display:none;
    }
    .faq-item.open .faq-panel{display:block}
    .faq-item.open .faq-icon{color:var(--text)}

    /* ============ TRILHA / CHECKIN ============ */
    .two-col{
      display:grid;
      grid-template-columns:1.15fr .85fr;
      gap:12px;
      align-items:start;
    }

    .kpi{
      border:1px solid var(--line);
      border-radius:16px;
      background:rgba(255,255,255,.02);
      padding:12px;
      display:flex;justify-content:space-between;gap:10px;
    }
    .kpi span{font-size:12px;color:var(--muted)}
    .kpi b{font-size:18px;letter-spacing:-.2px}

    .progress{
      margin-top:8px;
      height:10px;border-radius:999px;
      background:rgba(255,255,255,.07);
      overflow:hidden;
      border:1px solid rgba(255,255,255,.04);
    }
    .progress > div{
      height:100%;width:0%;
      background:linear-gradient(90deg,var(--violet),var(--cyan));
    }

    .field-label{
      font-size:12px;color:var(--muted);
      margin-bottom:6px;
      display:block;
    }
    .field{
      width:100%;
      border-radius:12px;
      border:1px solid var(--line);
      background:rgba(255,255,255,.02);
      color:var(--text);
      padding:11px 12px;
      outline:none;
    }
    .field:focus{
      border-color:rgba(53,211,255,.3);
      box-shadow:0 0 0 4px rgba(53,211,255,.08);
    }
    select.field option{color:#08111d;background:#0f1728}
    input[type="range"]{width:100%}

    .btn-row{display:flex;gap:8px;flex-wrap:wrap}

    .small{font-size:12px;color:var(--muted);line-height:1.6}
    .small.danger{color:#ffd6df}

    /* ============ MODAL CRISE ============ */
    .overlay{
      position:fixed;inset:0;
      background:rgba(0,0,0,.55);
      backdrop-filter:blur(8px);
      z-index:100;
      display:none;
    }
    .modal{
      position:fixed;
      left:50%;top:50%;
      transform:translate(-50%,-50%);
      width:min(760px, calc(100% - 24px));
      border-radius:22px;
      border:1px solid var(--line-2);
      background:linear-gradient(180deg, rgba(255,255,255,.06), rgba(255,255,255,.03));
      box-shadow:0 30px 100px rgba(0,0,0,.55);
      z-index:101;
      display:none;
      overflow:hidden;
    }
    .modal-head{
      padding:14px 14px 12px;
      border-bottom:1px solid var(--line);
      display:flex;justify-content:space-between;align-items:flex-start;gap:12px;
    }
    .modal-head h3{margin:0;font-size:16px}
    .modal-head p{margin:6px 0 0;color:var(--muted);font-size:13px;line-height:1.55}
    .icon-btn{
      width:38px;height:38px;border-radius:12px;
      border:1px solid var(--line);
      background:rgba(255,255,255,.02);
      color:var(--text);
      display:grid;place-items:center;
      cursor:pointer;
      flex:0 0 auto;
    }
    .modal-body{padding:14px}
    .modal-grid{
      display:grid;
      grid-template-columns:1fr 1fr;
      gap:10px;
    }
    .modal-card{
      border:1px solid var(--line);
      background:rgba(255,255,255,.02);
      border-radius:16px;
      padding:14px;
    }
    .modal-card h4{margin:0 0 8px;font-size:14px}
    .modal-card p{margin:0;color:var(--muted);font-size:13px;line-height:1.55}

    .breath-wrap{
      display:flex;gap:12px;align-items:center;
      margin-top:10px;
    }
    .breath-ball{
      width:82px;height:82px;border-radius:24px;
      background:
        radial-gradient(circle at 30% 30%, rgba(53,211,255,.22), transparent 65%),
        radial-gradient(circle at 70% 70%, rgba(140,91,255,.18), transparent 65%),
        rgba(255,255,255,.02);
      border:1px solid var(--line);
      box-shadow:0 8px 30px rgba(53,211,255,.08);
      transform:scale(1);
      flex:0 0 auto;
    }
    .breathing{animation:breathe 6s ease-in-out infinite}
    @keyframes breathe{
      0%{transform:scale(.92)}
      50%{transform:scale(1.08)}
      100%{transform:scale(.92)}
    }
    .timer b{display:block;font-size:20px;letter-spacing:-.5px}
    .timer span{font-size:12px;color:var(--muted)}

    .modal-note{
      margin-top:10px;
      font-size:12px;
      line-height:1.55;
      color:var(--muted);
    }

    /* ============ TOAST ============ */
    .toast{
      position:fixed;
      left:50%;bottom:16px;
      transform:translateX(-50%);
      padding:10px 12px;
      background:rgba(0,0,0,.6);
      color:var(--text);
      border-radius:999px;
      border:1px solid var(--line);
      backdrop-filter:blur(8px);
      font-size:13px;
      z-index:120;
      display:none;
    }

    /* ============ FOOTER ============ */
    footer{
      border-top:1px solid var(--line);
      margin-top:24px;
      padding:22px 0 38px;
    }

    /* ============ RESPONSIVE ============ */
    @media (max-width: 980px){
      .nav-links{display:none}
      .hero-grid{grid-template-columns:1fr}
      .hero h1{font-size:34px;max-width:none}
      .grid-3,.grid-2{grid-template-columns:1fr}
      .pricing{grid-template-columns:1fr}
      .two-col{grid-template-columns:1fr}
      .modal-grid{grid-template-columns:1fr}
      .section-head{align-items:flex-start;flex-direction:column}
      .section-head p{text-align:left}
      .brand{min-width:auto}
    }
  </style>
</head>
<body>

  <!-- ====== NAV ====== -->
  <div class="nav">
    <div class="wrap nav-inner">
      <div class="brand" id="goHome" aria-label="Ir para in√≠cio">
        <div class="brand-mark" aria-hidden="true">
          <!-- logo clean -->
          <svg viewBox="0 0 64 64" width="28" height="28">
            <defs>
              <linearGradient id="gLogo" x1="0" y1="0" x2="1" y2="1">
                <stop offset="0" stop-color="#ff59d8"/>
                <stop offset=".55" stop-color="#8c5bff"/>
                <stop offset="1" stop-color="#35d3ff"/>
              </linearGradient>
            </defs>
            <rect x="1" y="1" width="62" height="62" rx="18" fill="rgba(255,255,255,.01)"/>
            <path d="M18 35c-4-3-6-7-6-13 0-9 6-16 15-16 3 0 6 1 8 3 2-2 5-3 8-3 9 0 15 7 15 16 0 6-2 10-6 13-1 1-2 3-2 5 0 5-3 8-8 8-2 0-4-1-6-3-2 2-4 3-6 3-5 0-8-3-8-8 0-2-1-4-2-5Z" fill="url(#gLogo)" opacity=".95"/>
            <path d="M17 31h30" stroke="white" stroke-opacity=".8" stroke-width="5" stroke-linecap="round"/>
            <path d="M20 24h26" stroke="white" stroke-opacity=".2" stroke-width="5" stroke-linecap="round"/>
            <path d="M22 38h24" stroke="white" stroke-opacity=".2" stroke-width="5" stroke-linecap="round"/>
          </svg>
        </div>
        <div class="brand-text">
          <div class="title">Reprograma <span class="num">30</span></div>
          <div class="sub" id="navSubtitle">M√©todo Anti-V√≠cio ‚Ä¢ Progresso di√°rio</div>
        </div>
      </div>

      <div class="nav-links" id="navLinksHome">
        <a href="#metodo">M√©todo</a>
        <a href="#identificar">Trilhas</a>
        <a href="#planos">Planos</a>
        <a href="#faq">FAQ</a>
      </div>

      <div class="nav-links hidden" id="navLinksTrilha">
        <a href="#trilha">Trilha</a>
        <a href="#checkin">Check-in</a>
        <a href="#planos">Assinar</a>
      </div>

      <div class="nav-actions">
        <button class="btn btn-ghost btn-sm" id="btnCrisisTop" type="button">Modo crise</button>
        <button class="btn btn-primary btn-sm" id="btnPrimaryTop" type="button">Come√ßar</button>
      </div>
    </div>
  </div>

  <!-- ====== VIEW HOME ====== -->
  <main id="viewHome">
    <header>
      <div class="wrap">
        <div class="hero">
          <div class="hero-grid">
            <div>
              <div class="hero-kicker">
                <span class="pill"><span class="dot"></span>Sem julgamento</span>
                <span class="pill">Privacidade</span>
                <span class="pill">Um dia por vez</span>
              </div>

              <h1>Voc√™ n√£o √© fraco. Voc√™ est√° preso em um ciclo.</h1>
              <p class="lead">
                O <b>Reprograma 30</b> √© um m√©todo anti-v√≠cio (educacional e comportamental) com trilhas pr√°ticas para ajudar a pessoa a
                recuperar o controle com <b>estrutura di√°ria</b>, <b>interrup√ß√£o do impulso</b> e <b>progresso vis√≠vel</b>.
              </p>

              <div class="cta">
                <button class="btn btn-primary" id="btnStartIdentify" type="button">Quero me identificar</button>
                <a class="btn btn-ghost" href="#metodo">Entender o m√©todo</a>
                <button class="btn btn-soft" id="btnCrisisHero" type="button">Abrir modo crise</button>
              </div>

              <div class="warn">
                Aviso: suporte educacional/comportamental. N√£o substitui terapia/psiquiatria/tratamento m√©dico.
                Em situa√ß√£o de risco: procure ajuda profissional imediata (CVV 188 / Emerg√™ncia 192).
              </div>
            </div>

            <div class="hero-side">
              <div class="mini-card">
                <h3>O que a pessoa encontra ao entrar</h3>
                <p>Trilha por v√≠cio + plano de 30 dias + modo crise + check-in + recompensas para manter consist√™ncia.</p>
              </div>

              <div class="mini-list">
                <div class="item">
                  <span class="spark"></span>
                  <div>
                    <b>Trilhas por v√≠cio</b>
                    <span>Apostas ‚Ä¢ √Ålcool ‚Ä¢ Fumar ‚Ä¢ Pornografia ‚Ä¢ Drogas</span>
                  </div>
                </div>
                <div class="item">
                  <span class="spark"></span>
                  <div>
                    <b>8‚Äì12 min por dia</b>
                    <span>Conte√∫do direto, pr√°tico e f√°cil de aplicar</span>
                  </div>
                </div>
                <div class="item">
                  <span class="spark"></span>
                  <div>
                    <b>Modo crise premium</b>
                    <span>Respira√ß√£o guiada + a√ß√µes r√°pidas contra impulso</span>
                  </div>
                </div>
                <div class="item">
                  <span class="spark"></span>
                  <div>
                    <b>Progresso vis√≠vel</b>
                    <span>Streak + badges + certificado + relat√≥rio local</span>
                  </div>
                </div>
              </div>

              <div class="mini-card">
                <h3>Links diretos por trilha</h3>
                <p>Voc√™ pode divulgar links como <b>#apostas</b>, <b>#alcool</b>, <b>#fumar</b>, <b>#pornografia</b> e <b>#drogas</b>.</p>
              </div>
            </div>
          </div>
        </div>
      </div>
    </header>

    <section id="metodo">
      <div class="wrap">
        <div class="section-head">
          <h2>O m√©todo Anti-V√≠cio</h2>
          <p>Um sistema simples e repet√≠vel para vencer o momento cr√≠tico e construir consist√™ncia.</p>
        </div>

        <div class="grid grid-3">
          <div class="card">
            <h3>1) Consci√™ncia</h3>
            <p>A pessoa entende seu padr√£o: gatilhos, hor√°rios, emo√ß√µes e contexto. O v√≠cio sai do autom√°tico.</p>
          </div>
          <div class="card">
            <h3>2) Interrup√ß√£o</h3>
            <p>Regras simples, barreiras e modo crise para atravessar o impulso sem depender s√≥ de for√ßa de vontade.</p>
          </div>
          <div class="card">
            <h3>3) Reconstru√ß√£o</h3>
            <p>Substitui√ß√£o de h√°bito, rotina e refor√ßo de identidade para manter progresso ao longo do tempo.</p>
          </div>
        </div>

        <div class="grid grid-2" style="margin-top:12px">
          <div class="card">
            <h3>4) Progresso vis√≠vel</h3>
            <p>Check-ins, streak e recompensas mant√™m a pessoa no processo e aumentam percep√ß√£o de evolu√ß√£o.</p>
          </div>
          <div class="card">
            <h3>Por que as pessoas pagam?</h3>
            <p>Porque n√£o √© s√≥ conte√∫do: √© <b>estrutura guiada</b>, <b>organiza√ß√£o</b> e <b>aplica√ß√£o pr√°tica</b>.</p>
          </div>
        </div>
      </div>
    </section>

    <section id="identificar">
      <div class="wrap">
        <div class="section-head">
          <h2>Escolha sua trilha</h2>
          <p>Clique no que mais representa seu momento. Voc√™ entra em uma p√°gina espec√≠fica e j√° pode come√ßar.</p>
        </div>

        <div class="grid grid-3">
          <div class="card choice" data-v="apostas" tabindex="0" role="button">
            <div>
              <h3>üéØ Apostas</h3>
              <p>‚ÄúS√≥ mais uma‚Äù, recuperar perda, ansiedade, culpa e impulsos no celular.</p>
              <div class="divider"></div>
              <span class="badge bad">urg√™ncia</span>
              <span class="badge warn">impulso</span>
              <span class="badge warn">gatilho digital</span>
            </div>
            <div class="choice-right"><span class="badge good">Abrir</span></div>
          </div>

          <div class="card choice" data-v="alcool" tabindex="0" role="button">
            <div>
              <h3>üç∫ √Ålcool</h3>
              <p>‚ÄúS√≥ hoje‚Äù, social, fim de semana, estresse e reca√≠das repetidas.</p>
              <div class="divider"></div>
              <span class="badge warn">social</span>
              <span class="badge warn">rotina</span>
            </div>
            <div class="choice-right"><span class="badge good">Abrir</span></div>
          </div>

          <div class="card choice" data-v="fumar" tabindex="0" role="button">
            <div>
              <h3>üö¨ Fumar</h3>
              <p>Autom√°tico, ‚Äúpausa‚Äù, ansiedade e momentos fixos do dia.</p>
              <div class="divider"></div>
              <span class="badge warn">h√°bito</span>
              <span class="badge warn">ansiedade</span>
            </div>
            <div class="choice-right"><span class="badge good">Abrir</span></div>
          </div>

          <div class="card choice" data-v="pornografia" tabindex="0" role="button">
            <div>
              <h3>üß† Pornografia</h3>
              <p>Compuls√£o, escapismo, culpa e gatilhos digitais (noite/celular).</p>
              <div class="divider"></div>
              <span class="badge warn">gatilho digital</span>
              <span class="badge warn">isolamento</span>
            </div>
            <div class="choice-right"><span class="badge good">Abrir</span></div>
          </div>

          <div class="card choice" data-v="drogas" tabindex="0" role="button">
            <div>
              <h3>‚ö†Ô∏è Drogas</h3>
              <p>Ambiente, companhia, fuga emocional e reca√≠das por gatilhos sociais.</p>
              <div class="divider"></div>
              <span class="badge bad">aten√ß√£o</span>
              <span class="badge warn">apoio</span>
            </div>
            <div class="choice-right"><span class="badge good">Abrir</span></div>
          </div>

          <div class="card">
            <h3>N√£o sabe qual?</h3>
            <p>Comece pelo v√≠cio que mais est√° te prejudicando hoje. Depois voc√™ pode trocar de trilha.</p>
            <div class="divider"></div>
            <button class="btn btn-primary btn-block" id="btnStartAny" type="button">Come√ßar agora</button>
          </div>
        </div>
      </div>
    </section>

    <section id="planos">
      <div class="wrap">
        <div class="section-head">
          <h2>Planos de acesso</h2>
          <p>Escolha a forma de acesso. Os links Kiwify j√° est√£o configurados.</p>
        </div>

        <div class="pricing">
          <div class="card price">
            <h3>Mensal</h3>
            <div class="money">R$ 29 <small>/ m√™s</small></div>
            <p class="small">Acesso completo para come√ßar agora.</p>

            <ul class="features">
              <li><span class="check">‚úì</span><span>Todas as trilhas (5 v√≠cios)</span></li>
              <li><span class="check">‚úì</span><span>Programa de 30 dias</span></li>
              <li><span class="check">‚úì</span><span>Modo crise + progresso vis√≠vel</span></li>
            </ul>

            <div style="margin-top:14px">
              <a class="btn btn-primary btn-block" href="https://pay.kiwify.com.br/RrMdJme" target="_blank" rel="noopener">Assinar mensal</a>
            </div>
          </div>

          <div class="card price best">
            <span class="ribbon">MAIS VENDIDO</span>
            <h3>Trimestral</h3>
            <div class="money">R$ 69 <small>/ 3 meses</small></div>
            <p class="small">Mais tempo para consolidar resultados e reduzir reca√≠das.</p>

            <ul class="features">
              <li><span class="check">‚úì</span><span>Melhor custo/benef√≠cio</span></li>
              <li><span class="check">‚úì</span><span>Ideal para consolidar h√°bito (90 dias)</span></li>
              <li><span class="check">‚úì</span><span>Continuidade e consist√™ncia</span></li>
            </ul>

            <div style="margin-top:14px">
              <a class="btn btn-primary btn-block" href="https://pay.kiwify.com.br/Kgog3p3" target="_blank" rel="noopener">Assinar trimestral</a>
            </div>
          </div>
        </div>
      </div>
    </section>

    <section id="faq">
      <div class="wrap">
        <div class="section-head">
          <h2>Perguntas frequentes</h2>
          <p>FAQ organizado e funcional (abre uma pergunta por vez).</p>
        </div>

        <div class="faq-list" id="faqList">
          <div class="faq-item">
            <button class="faq-btn" type="button" aria-expanded="false">
              <span>Isso √© terapia?</span>
              <span class="faq-icon">+</span>
            </button>
            <div class="faq-panel">
              N√£o. √â apoio educacional/comportamental. Em casos graves, o ideal √© acompanhamento profissional junto.
            </div>
          </div>

          <div class="faq-item">
            <button class="faq-btn" type="button" aria-expanded="false">
              <span>Se eu recair, acabou?</span>
              <span class="faq-icon">+</span>
            </button>
            <div class="faq-panel">
              N√£o. O m√©todo inclui retomada. O foco √© interromper o ciclo culpa ‚Üí repeti√ß√£o e voltar ao plano.
            </div>
          </div>

          <div class="faq-item">
            <button class="faq-btn" type="button" aria-expanded="false">
              <span>Como existe recompensa sem gastar nada?</span>
              <span class="faq-icon">+</span>
            </button>
            <div class="faq-panel">
              Badges, certificado e relat√≥rio s√£o gerados no navegador (local), sem custo de servidor.
            </div>
          </div>

          <div class="faq-item">
            <button class="faq-btn" type="button" aria-expanded="false">
              <span>Posso trocar de trilha?</span>
              <span class="faq-icon">+</span>
            </button>
            <div class="faq-panel">
              Sim. Voc√™ pode come√ßar pelo v√≠cio mais urgente e depois mudar quando quiser.
            </div>
          </div>
        </div>
      </div>
    </section>

    <footer>
      <div class="wrap">
        <p class="small">
          <b>Reprograma 30</b> √© suporte educacional/comportamental. N√£o substitui tratamento profissional.
          Em risco imediato: CVV 188 / Emerg√™ncia 192.
        </p>
        <p class="small">¬© <span id="yearHome"></span> Reprograma 30.</p>
      </div>
    </footer>
  </main>

  <!-- ====== VIEW TRILHA ====== -->
  <main id="viewTrilha" class="hidden">
    <header>
      <div class="wrap">
        <div class="hero">
          <div class="hero-kicker">
            <span class="pill"><span class="dot"></span><span id="pillType">Trilha</span></span>
            <span class="pill">8‚Äì12 min/dia</span>
            <span class="pill">Progresso vis√≠vel</span>
          </div>

          <h1 id="trTitle">Trilha</h1>
          <p class="lead" id="trDesc">‚Ä¶</p>

          <div class="cta">
            <button class="btn btn-primary" id="btnDay1" type="button">Come√ßar Dia 1</button>
            <button class="btn btn-ghost" id="btnCrisisTrilha" type="button">Modo crise</button>
            <a class="btn btn-soft" href="#planos">Ver planos</a>
          </div>

          <div class="warn">
            Aviso: suporte educacional/comportamental. N√£o substitui tratamento profissional.
          </div>
        </div>
      </div>
    </header>

    <section id="trilha">
      <div class="wrap">
        <div class="section-head">
          <h2>Estrutura da trilha (30 dias)</h2>
          <p>Mesma l√≥gica do m√©todo ‚Äî mudam os exemplos, gatilhos e a√ß√µes pr√°ticas.</p>
        </div>

        <div class="grid grid-2">
          <div class="card">
            <h3>Fase 1 ‚Äî Consci√™ncia (1‚Äì7)</h3>
            <p id="p1">‚Ä¶</p>
          </div>
          <div class="card">
            <h3>Fase 2 ‚Äî Interrup√ß√£o (8‚Äì14)</h3>
            <p id="p2">‚Ä¶</p>
          </div>
          <div class="card">
            <h3>Fase 3 ‚Äî Reconstru√ß√£o (15‚Äì21)</h3>
            <p id="p3">‚Ä¶</p>
          </div>
          <div class="card">
            <h3>Fase 4 ‚Äî Consolida√ß√£o (22‚Äì30)</h3>
            <p id="p4">‚Ä¶</p>
          </div>
        </div>

        <div class="card" style="margin-top:12px">
          <h3>O que pode mudar em 7 dias</h3>
          <p id="in7">‚Ä¶</p>
          <div class="divider"></div>
          <h3>O que pode mudar em 30 dias</h3>
          <p id="in30">‚Ä¶</p>
        </div>
      </div>
    </section>

    <section id="checkin">
      <div class="wrap">
        <div class="section-head">
          <h2>Check-in di√°rio (demo local)</h2>
          <p>Salvo no navegador. Zero custo. Isso gera consist√™ncia e refor√ßo visual.</p>
        </div>

        <div class="two-col">
          <div class="card">
            <h3>Seu progresso</h3>
            <div class="divider"></div>

            <div class="kpi">
              <div><span>Streak</span><br><b id="streak">0</b></div>
              <div style="text-align:right"><span>√öltimo check-in</span><br><b id="last">‚Äî</b></div>
            </div>
            <div class="progress"><div id="progBar"></div></div>

            <div class="divider"></div>

            <label class="field-label" for="ciDid">Hoje eu‚Ä¶</label>
            <select class="field" id="ciDid">
              <option value="ok">N√£o ca√≠</option>
              <option value="slip">Quase ca√≠</option>
              <option value="relapse">Ca√≠</option>
            </select>

            <div class="divider"></div>

            <label class="field-label" for="ciUrge">Vontade (0 a 5)</label>
            <input id="ciUrge" type="range" min="0" max="5" value="2">

            <div class="divider"></div>

            <label class="field-label" for="ciTrig">Gatilho principal</label>
            <select class="field" id="ciTrig">
              <option>T√©dio</option>
              <option>Ansiedade/Estresse</option>
              <option>Tristeza/Solid√£o</option>
              <option>Ambiente/Social</option>
              <option>Celular/Feed</option>
            </select>

            <div class="btn-row" style="margin-top:12px">
              <button class="btn btn-primary" id="btnCheckin" type="button">Salvar check-in</button>
              <button class="btn btn-ghost" id="btnReset" type="button">Zerar</button>
            </div>

            <div class="btn-row" style="margin-top:10px">
              <button class="btn btn-ghost" id="btnBadges" type="button">Badges</button>
              <button class="btn btn-ghost" id="btnCert" type="button">Certificado</button>
              <button class="btn btn-ghost" id="btnReport" type="button">Relat√≥rio</button>
            </div>
          </div>

          <div class="card">
            <h3>Recompensas (zero custo)</h3>
            <p class="small">Progresso vis√≠vel aumenta perman√™ncia e percep√ß√£o de evolu√ß√£o.</p>

            <div class="divider"></div>
            <p class="small" id="rewardText">Fa√ßa 7 dias seguidos sem cair e desbloqueie certificado + badge.</p>

            <div class="divider"></div>
            <h3>Assinar acesso completo</h3>
            <p class="small">Para liberar conte√∫do completo das trilhas + continuidade de 90 dias.</p>

            <div class="btn-row" style="margin-top:10px">
              <a class="btn btn-primary btn-block" href="https://pay.kiwify.com.br/RrMdJme" target="_blank" rel="noopener">Assinar mensal</a>
              <a class="btn btn-soft btn-block" href="https://pay.kiwify.com.br/Kgog3p3" target="_blank" rel="noopener">Assinar trimestral</a>
            </div>

            <div class="divider"></div>
            <p class="small">
              Dica de divulga√ß√£o: envie link direto da trilha (ex.: <b>seusite.com/#apostas</b>).
            </p>
          </div>
        </div>
      </div>
    </section>

    <section id="planos">
      <div class="wrap">
        <div class="section-head">
          <h2>Planos de acesso</h2>
          <p>Mensal ou trimestral. Mesmos links Kiwify.</p>
        </div>

        <div class="pricing">
          <div class="card price">
            <h3>Mensal</h3>
            <div class="money">R$ 29 <small>/ m√™s</small></div>
            <ul class="features">
              <li><span class="check">‚úì</span><span>Todas as trilhas</span></li>
              <li><span class="check">‚úì</span><span>Conte√∫do completo 30 dias</span></li>
              <li><span class="check">‚úì</span><span>Modo crise e progresso</span></li>
            </ul>
            <div style="margin-top:14px">
              <a class="btn btn-primary btn-block" href="https://pay.kiwify.com.br/RrMdJme" target="_blank" rel="noopener">Assinar mensal</a>
            </div>
          </div>

          <div class="card price best">
            <span class="ribbon">MAIS VENDIDO</span>
            <h3>Trimestral</h3>
            <div class="money">R$ 69 <small>/ 3 meses</small></div>
            <ul class="features">
              <li><span class="check">‚úì</span><span>Melhor custo/benef√≠cio</span></li>
              <li><span class="check">‚úì</span><span>90 dias para consolidar</span></li>
              <li><span class="check">‚úì</span><span>Mais continuidade</span></li>
            </ul>
            <div style="margin-top:14px">
              <a class="btn btn-primary btn-block" href="https://pay.kiwify.com.br/Kgog3p3" target="_blank" rel="noopener">Assinar trimestral</a>
            </div>
          </div>
        </div>
      </div>
    </section>

    <footer>
      <div class="wrap">
        <p class="small">
          <b>Reprograma 30</b> √© suporte educacional/comportamental. N√£o substitui tratamento profissional.
        </p>
        <p class="small">¬© <span id="yearTrilha"></span> Reprograma 30.</p>
      </div>
    </footer>
  </main>

  <!-- ====== MODAL CRISE ====== -->
  <div class="overlay" id="overlay"></div>
  <div class="modal" id="crisisModal" role="dialog" aria-modal="true" aria-labelledby="crisisTitle">
    <div class="modal-head">
      <div>
        <h3 id="crisisTitle">Modo Crise</h3>
        <p>Seu objetivo agora √© s√≥ atravessar a vontade. Reduza a urg√™ncia e volte pro controle.</p>
      </div>
      <button class="icon-btn" id="btnCloseModal" type="button" aria-label="Fechar">‚úï</button>
    </div>

    <div class="modal-body">
      <div class="modal-grid">
        <div class="modal-card">
          <h4>Respira√ß√£o guiada (2 min)</h4>
          <p>Inspire 4s ‚Ä¢ segure 2s ‚Ä¢ solte 6s. Continue at√© a urg√™ncia diminuir.</p>

          <div class="breath-wrap">
            <div class="breath-ball" id="breathBall" aria-hidden="true"></div>
            <div class="timer">
              <b id="breathTimer">02:00</b>
              <span id="breathHint">Pronto para iniciar.</span>
            </div>
          </div>

          <div class="btn-row" style="margin-top:12px">
            <button class="btn btn-primary" id="btnBreathStart" type="button">Iniciar</button>
            <button class="btn btn-ghost" id="btnBreathStop" type="button">Parar</button>
          </div>
        </div>

        <div class="modal-card">
          <h4>A√ß√µes r√°pidas (30‚Äì60s)</h4>
          <p>Escolha uma agora. Mudar o corpo e o ambiente reduz o impulso.</p>

          <div class="btn-row" style="margin-top:10px">
            <button class="btn btn-ghost" id="btnActionWater" type="button">Beber √°gua</button>
            <button class="btn btn-ghost" id="btnActionMove" type="button">Mover o corpo</button>
            <button class="btn btn-ghost" id="btnActionCut" type="button">Cortar gatilho</button>
            <button class="btn btn-soft" id="btnActionCheckin" type="button">Ir pro check-in</button>
          </div>

          <div class="modal-note">
            Se houver risco √† sua seguran√ßa, procure ajuda profissional imediatamente (CVV 188 / Emerg√™ncia 192).
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- toast -->
  <div class="toast" id="toast"></div>

  <script>
    // =========================
    // HELPERS
    // =========================
    const $ = (id) => document.getElementById(id);

    function toast(msg){
      const t = $("toast");
      t.textContent = msg;
      t.style.display = "block";
      clearTimeout(window.__toastTimer);
      window.__toastTimer = setTimeout(() => t.style.display = "none", 2500);
    }

    $("yearHome").textContent = new Date().getFullYear();
    $("yearTrilha").textContent = new Date().getFullYear();

    // =========================
    // VIEWS (SPA)
    // =========================
    const viewHome = $("viewHome");
    const viewTrilha = $("viewTrilha");
    const navLinksHome = $("navLinksHome");
    const navLinksTrilha = $("navLinksTrilha");
    const navSubtitle = $("navSubtitle");
    const btnPrimaryTop = $("btnPrimaryTop");

    function showHome(push = true){
      viewHome.classList.remove("hidden");
      viewTrilha.classList.add("hidden");
      navLinksHome.classList.remove("hidden");
      navLinksTrilha.classList.add("hidden");
      navSubtitle.textContent = "M√©todo Anti-V√≠cio ‚Ä¢ Progresso di√°rio";
      btnPrimaryTop.textContent = "Come√ßar";
      btnPrimaryTop.onclick = null;

      if(push) history.pushState({view:"home"}, "", "#");
      window.scrollTo({top:0, behavior:"smooth"});
    }

    function showTrilha(v, push = true){
      const d = DATA[v] || DATA.apostas;

      viewHome.classList.add("hidden");
      viewTrilha.classList.remove("hidden");
      navLinksHome.classList.add("hidden");
      navLinksTrilha.classList.remove("hidden");
      navSubtitle.textContent = d.pill;
      btnPrimaryTop.textContent = "Assinar";
      btnPrimaryTop.onclick = () => document.getElementById("planos").scrollIntoView({behavior:"smooth", block:"start"});

      applyTrilha(v);

      if(push) history.pushState({view:"trilha", v}, "", "#" + v);
      window.scrollTo({top:0, behavior:"smooth"});
    }

    $("goHome").addEventListener("click", () => showHome(true));

    btnPrimaryTop.addEventListener("click", () => {
      if(!viewHome.classList.contains("hidden")){
        document.getElementById("identificar").scrollIntoView({behavior:"smooth", block:"start"});
      }else{
        document.getElementById("planos").scrollIntoView({behavior:"smooth", block:"start"});
      }
    });

    $("btnStartIdentify").addEventListener("click", () => {
      document.getElementById("identificar").scrollIntoView({behavior:"smooth", block:"start"});
    });
    $("btnStartAny").addEventListener("click", () => showTrilha("apostas", true));

    // =========================
    // DATA (TRILHAS)
    // =========================
    const DATA = {
      apostas:{
        pill:"Trilha ‚Ä¢ Apostas",
        title:"Apostas: recuperar controle e quebrar o ciclo do ‚Äús√≥ mais uma‚Äù",
        desc:"Voc√™ vai reduzir gatilhos digitais, organizar o momento cr√≠tico e reconstruir controle emocional e financeiro ‚Äî um dia por vez.",
        p1:"Diagn√≥stico real (perdas/padr√µes), ciclo do quase-ganho e mapeamento de gatilhos (t√©dio, ansiedade, celular).",
        p2:"Bloqueio de apps/sites, limpeza de feed, regra das 24h e t√©cnica de adiamento do impulso.",
        p3:"Rotina para hor√°rios cr√≠ticos, reestrutura√ß√£o financeira simples e substitui√ß√£o de dopamina.",
        p4:"Plano anti-reca√≠da, continuidade de 90 dias e refor√ßo de identidade de controle.",
        in7:"Menos gatilhos no celular, menos impulso autom√°tico e mais clareza sobre o que te derruba.",
        in30:"Mais controle emocional/financeiro, menos reca√≠das e rotina est√°vel para manuten√ß√£o.",
        day1Title:"Dia 1 ‚Äî Diagn√≥stico real (Apostas)",
        day1Text:"Escreva perdas, gatilhos, hor√°rios, emo√ß√µes e custo invis√≠vel (ansiedade/culpa). Clareza corta o autom√°tico."
      },
      alcool:{
        pill:"Trilha ‚Ä¢ √Ålcool",
        title:"√Ålcool: sair do ‚Äús√≥ hoje‚Äù e quebrar o padr√£o de fim de semana",
        desc:"Voc√™ vai mapear gatilhos sociais, criar alternativas reais e organizar uma rotina que sustente consist√™ncia.",
        p1:"Mapeamento de situa√ß√µes sociais, emo√ß√µes e rota t√≠pica de reca√≠da (sexta/s√°bado).",
        p2:"Plano de ambiente, alternativas sociais e regras de prote√ß√£o para eventos e encontros.",
        p3:"Rotina, sono, energia e manejo de estresse com recompensas saud√°veis.",
        p4:"Plano de 90 dias e preven√ß√£o de reca√≠da em datas e eventos cr√≠ticos.",
        in7:"Mais consci√™ncia de onde voc√™ escorrega e um plano claro para eventos sociais.",
        in30:"Mais consist√™ncia, melhor energia/sono e menos depend√™ncia do ‚Äúpux√£o social‚Äù.",
        day1Title:"Dia 1 ‚Äî Mapa do padr√£o (√Ålcool)",
        day1Text:"Escreva quando bebe, com quem, por qu√™ e o que acontece depois. Marque 3 gatilhos e 1 ajuste de ambiente."
      },
      fumar:{
        pill:"Trilha ‚Ä¢ Fumar",
        title:"Fumar: quebrar o autom√°tico e substituir a ‚Äúpausa‚Äù",
        desc:"Voc√™ vai identificar gatilhos fixos, trocar pausas autom√°ticas e criar um plano simples para ansiedade.",
        p1:"Mapeamento do padr√£o ‚Äúcigarro = pausa‚Äù (trabalho, caf√©, estresse) e gatilhos fixos.",
        p2:"Substitui√ß√£o de pausa, redu√ß√£o de acessibilidade e regra de atraso.",
        p3:"Rotina curta para ansiedade (respira√ß√£o, √°gua, caminhada r√°pida).",
        p4:"Consolida√ß√£o, preven√ß√£o de reca√≠da e refor√ßo de continuidade.",
        in7:"Menos autom√°tico e mais pausas funcionais sem depender do cigarro.",
        in30:"Novo padr√£o, mais f√¥lego/energia e maior controle nos hor√°rios cr√≠ticos.",
        day1Title:"Dia 1 ‚Äî Gatilhos fixos (Fumar)",
        day1Text:"Liste 5 momentos autom√°ticos e escreva uma alternativa de 2 minutos para cada um."
      },
      pornografia:{
        pill:"Trilha ‚Ä¢ Pornografia",
        title:"Pornografia: quebrar compuls√£o e reduzir gatilhos digitais",
        desc:"Voc√™ vai reduzir exposi√ß√£o, criar barreiras no ambiente digital e reconstruir rotina, foco e energia.",
        p1:"Mapeamento de gatilhos (noite, solid√£o, t√©dio, celular) e ciclo culpa ‚Üí repeti√ß√£o.",
        p2:"Higiene digital, barreiras, regra de atraso e protocolo de crise.",
        p3:"Substitui√ß√£o de h√°bito, rotina de energia e reconstru√ß√£o de foco.",
        p4:"Plano de continuidade (90 dias), preven√ß√£o de reca√≠da e identidade.",
        in7:"Redu√ß√£o de gatilhos digitais e queda da compuls√£o por menor exposi√ß√£o.",
        in30:"Mais foco/energia, rotina melhor e barreiras mais fortes contra reca√≠das.",
        day1Title:"Dia 1 ‚Äî Padr√£o e gatilhos (Pornografia)",
        day1Text:"Escreva hor√°rio cr√≠tico, emo√ß√£o e contexto. Remova hoje 1 gatilho digital (app, conta, hist√≥rico)."
      },
      drogas:{
        pill:"Trilha ‚Ä¢ Drogas",
        title:"Drogas: reduzir risco, reorganizar ambiente e construir consist√™ncia",
        desc:"Foco em ambiente, exposi√ß√£o, rotina e prote√ß√£o. Em casos graves, busque apoio profissional junto.",
        p1:"Mapeamento de ambientes, pessoas e gatilhos emocionais + ciclo de uso e consequ√™ncias.",
        p2:"Plano de prote√ß√£o, redu√ß√£o de exposi√ß√£o e plano de sa√≠da de situa√ß√µes de risco.",
        p3:"Rotina estruturada, substitui√ß√£o e responsabilidade com check-in.",
        p4:"Preven√ß√£o de reca√≠da, continuidade e refor√ßo de rede de apoio.",
        in7:"Mais clareza sobre ambientes de risco e a√ß√µes de prote√ß√£o imediata.",
        in30:"Rotina mais est√°vel e menos exposi√ß√£o, reduzindo chance de reca√≠da.",
        day1Title:"Dia 1 ‚Äî Ambiente e risco (Drogas)",
        day1Text:"Liste 3 ambientes/pessoas de risco e 3 a√ß√µes de prote√ß√£o. Se houver risco √† seguran√ßa, procure ajuda."
      }
    };

    let currentV = "apostas";

    function applyTrilha(v){
      currentV = v;
      const d = DATA[v] || DATA.apostas;

      $("pillType").textContent = d.pill;
      $("trTitle").textContent = d.title;
      $("trDesc").textContent = d.desc;
      $("p1").textContent = d.p1;
      $("p2").textContent = d.p2;
      $("p3").textContent = d.p3;
      $("p4").textContent = d.p4;
      $("in7").textContent = d.in7;
      $("in30").textContent = d.in30;

      localStorage.setItem("rp30_selected", v);
      updateCheckinUI();
    }

    // cards abrir trilha
    document.querySelectorAll(".choice[data-v]").forEach(el => {
      const open = () => showTrilha(el.dataset.v, true);
      el.addEventListener("click", open);
      el.addEventListener("keydown", (e) => {
        if(e.key === "Enter" || e.key === " "){
          e.preventDefault();
          open();
        }
      });
    });

    $("btnDay1").addEventListener("click", () => {
      const d = DATA[currentV] || DATA.apostas;
      alert(`${d.day1Title}\n\n${d.day1Text}\n\nExerc√≠cio: escreva 10 linhas e fa√ßa seu check-in.`);
      document.getElementById("checkin").scrollIntoView({behavior:"smooth", block:"start"});
    });

    // =========================
    // FAQ ACCORDION (ABRE 1 S√ì)
    // =========================
    (function initFAQ(){
      const root = $("faqList");
      if(!root) return;

      const items = Array.from(root.querySelectorAll(".faq-item"));

      items.forEach(item => {
        const btn = item.querySelector(".faq-btn");
        const icon = item.querySelector(".faq-icon");

        btn.addEventListener("click", () => {
          const isOpen = item.classList.contains("open");

          // fecha todos
          items.forEach(i => {
            i.classList.remove("open");
            const b = i.querySelector(".faq-btn");
            const ic = i.querySelector(".faq-icon");
            if(b) b.setAttribute("aria-expanded", "false");
            if(ic) ic.textContent = "+";
          });

          // abre o clicado se ele n√£o estava aberto
          if(!isOpen){
            item.classList.add("open");
            btn.setAttribute("aria-expanded", "true");
            icon.textContent = "‚Äì";
          }
        });
      });
    })();

    // =========================
    // MODO CRISE (MODAL)
    // =========================
    const overlay = $("overlay");
    const crisisModal = $("crisisModal");

    function openCrisisModal(){
      overlay.style.display = "block";
      crisisModal.style.display = "block";
      document.body.style.overflow = "hidden";
    }
    function closeCrisisModal(){
      overlay.style.display = "none";
      crisisModal.style.display = "none";
      document.body.style.overflow = "";
      stopBreathing();
    }

    $("btnCrisisTop").addEventListener("click", openCrisisModal);
    $("btnCrisisHero").addEventListener("click", openCrisisModal);
    $("btnCrisisTrilha").addEventListener("click", openCrisisModal);
    $("btnCloseModal").addEventListener("click", closeCrisisModal);
    overlay.addEventListener("click", closeCrisisModal);

    document.addEventListener("keydown", (e) => {
      if(e.key === "Escape") closeCrisisModal();
    });

    // respira√ß√£o
    const breathBall = $("breathBall");
    const breathTimer = $("breathTimer");
    const breathHint = $("breathHint");

    let breathInterval = null;
    let breathSeconds = 120;

    function fmtTimer(sec){
      const m = String(Math.floor(sec / 60)).padStart(2, "0");
      const s = String(sec % 60).padStart(2, "0");
      return `${m}:${s}`;
    }

    function startBreathing(){
      stopBreathing();
      breathSeconds = 120;
      breathTimer.textContent = fmtTimer(breathSeconds);
      breathHint.textContent = "Siga o ritmo visual.";
      breathBall.classList.add("breathing");

      breathInterval = setInterval(() => {
        breathSeconds--;
        breathTimer.textContent = fmtTimer(Math.max(0, breathSeconds));

        if(breathSeconds <= 0){
          stopBreathing();
          breathTimer.textContent = "Feito ‚úÖ";
          breathHint.textContent = "Boa. Agora escolha uma a√ß√£o r√°pida.";
          toast("Respira√ß√£o conclu√≠da.");
        }
      }, 1000);
    }

    function stopBreathing(){
      if(breathInterval){
        clearInterval(breathInterval);
        breathInterval = null;
      }
      breathBall.classList.remove("breathing");
    }

    $("btnBreathStart").addEventListener("click", startBreathing);
    $("btnBreathStop").addEventListener("click", () => {
      stopBreathing();
      breathHint.textContent = "Parado.";
      toast("Respira√ß√£o pausada.");
    });

    $("btnActionWater").addEventListener("click", () => toast("Beba √°gua agora e afaste-se do gatilho."));
    $("btnActionMove").addEventListener("click", () => toast("Fa√ßa 10 agachamentos ou caminhe 1 minuto."));
    $("btnActionCut").addEventListener("click", () => toast("Feche app/site e saia do ambiente por 5 min."));
    $("btnActionCheckin").addEventListener("click", () => {
      closeCrisisModal();
      if(viewTrilha.classList.contains("hidden")){
        showTrilha(localStorage.getItem("rp30_selected") || "apostas", true);
        setTimeout(() => document.getElementById("checkin").scrollIntoView({behavior:"smooth", block:"start"}), 250);
      }else{
        document.getElementById("checkin").scrollIntoView({behavior:"smooth", block:"start"});
      }
    });

    // =========================
    // CHECK-IN (LOCALSTORAGE)
    // =========================
    function storageKey(){
      return "rp30_checkins_" + currentV;
    }

    function loadCheckins(){
      try{
        return JSON.parse(localStorage.getItem(storageKey()) || "[]");
      }catch{
        return [];
      }
    }

    function saveCheckins(arr){
      localStorage.setItem(storageKey(), JSON.stringify(arr));
    }

    function formatDateBr(iso){
      return new Date(iso).toLocaleDateString("pt-BR");
    }

    function getStreak(arr){
      let streak = 0;
      for(let i = arr.length - 1; i >= 0; i--){
        if(arr[i].did === "ok") streak++;
        else break;
      }
      return streak;
    }

    function updateCheckinUI(){
      const arr = loadCheckins();
      const last = arr.length ? arr[arr.length - 1].date : null;
      const streak = getStreak(arr);

      $("last").textContent = last ? formatDateBr(last) : "‚Äî";
      $("streak").textContent = String(streak);

      const pct = Math.round((Math.min(streak, 30) / 30) * 100);
      $("progBar").style.width = pct + "%";

      if(streak >= 30){
        $("rewardText").textContent = "üèÜ 30 dias! Certificado e relat√≥rio liberados. Voc√™ venceu HOJE, repetidas vezes.";
      }else if(streak >= 14){
        $("rewardText").textContent = "üî• 14 dias! Badge 'Fortalecimento' desbloqueado.";
      }else if(streak >= 7){
        $("rewardText").textContent = "‚úÖ 7 dias! Badge 'Primeira Semana' + certificado liberado.";
      }else if(streak >= 3){
        $("rewardText").textContent = "‚úÖ 3 dias! Badge 'In√≠cio Forte' desbloqueado.";
      }else{
        $("rewardText").textContent = "Fa√ßa 7 dias seguidos sem cair e desbloqueie certificado + badge.";
      }
    }

    $("btnCheckin").addEventListener("click", () => {
      const arr = loadCheckins();
      arr.push({
        date: new Date().toISOString(),
        did: $("ciDid").value,
        urge: Number($("ciUrge").value),
        trigger: $("ciTrig").value
      });
      saveCheckins(arr);
      updateCheckinUI();
      toast("Check-in salvo.");
    });

    $("btnReset").addEventListener("click", () => {
      localStorage.removeItem(storageKey());
      updateCheckinUI();
      toast("Progresso zerado.");
    });

    $("btnBadges").addEventListener("click", () => {
      const streak = getStreak(loadCheckins());
      const badges = [];
      if(streak >= 3) badges.push("üèÖ In√≠cio Forte (3 dias)");
      if(streak >= 7) badges.push("üèÖ Primeira Semana (7 dias)");
      if(streak >= 14) badges.push("üèÖ Fortalecimento (14 dias)");
      if(streak >= 30) badges.push("üèÜ Reprograma 30 (30 dias)");

      alert(badges.length
        ? "Badges desbloqueados:\n\n" + badges.join("\n")
        : "Nenhum badge ainda. Fa√ßa 3 dias seguidos sem cair para desbloquear o primeiro.");
    });

    function downloadText(filename, content){
      const blob = new Blob([content], { type: "text/plain;charset=utf-8" });
      const url = URL.createObjectURL(blob);
      const a = document.createElement("a");
      a.href = url;
      a.download = filename;
      document.body.appendChild(a);
      a.click();
      a.remove();
      URL.revokeObjectURL(url);
    }

    $("btnCert").addEventListener("click", () => {
      const arr = loadCheckins();
      const streak = getStreak(arr);

      if(streak < 7){
        alert("Para gerar o certificado, desbloqueie 7 dias seguidos sem cair.");
        return;
      }

      const name = prompt("Nome/apelido para o certificado:", "An√¥nimo") || "An√¥nimo";
      const d = DATA[currentV] || DATA.apostas;

      const txt = `CERTIFICADO ‚Äî REPROGRAMA 30

Trilha: ${d.pill.replace("Trilha ‚Ä¢ ","")}
Emitido em: ${new Date().toLocaleDateString("pt-BR")}

Certificamos que ${name}
atingiu ${streak} dias de consist√™ncia.

"Voc√™ n√£o venceu para sempre.
Voc√™ venceu HOJE.
E isso, repetido, muda uma vida."

(Reprograma 30 ‚Äî apoio educacional/comportamental)
`;
      downloadText(`certificado-${currentV}-${name}.txt`, txt);
      toast("Certificado baixado.");
    });

    $("btnReport").addEventListener("click", () => {
      const arr = loadCheckins();
      if(!arr.length){
        alert("Fa√ßa pelo menos 1 check-in para gerar relat√≥rio.");
        return;
      }

      const last30 = arr.slice(-30);
      const avgUrge = (last30.reduce((s, x) => s + (x.urge || 0), 0) / last30.length).toFixed(2);

      const trigMap = {};
      last30.forEach(x => {
        trigMap[x.trigger] = (trigMap[x.trigger] || 0) + 1;
      });

      const topTrig = Object.entries(trigMap)
        .sort((a,b) => b[1] - a[1])
        .slice(0,3)
        .map(([k,v]) => `- ${k}: ${v}`)
        .join("\n") || "- ‚Äî";

      const d = DATA[currentV] || DATA.apostas;
      const streak = getStreak(arr);

      const txt = `RELAT√ìRIO ‚Äî REPROGRAMA 30 (DEMO LOCAL)

Trilha: ${d.pill.replace("Trilha ‚Ä¢ ","")}
Gerado em: ${new Date().toLocaleString("pt-BR")}

- Streak atual: ${streak}
- Check-ins analisados: ${last30.length}
- Vontade m√©dia (0‚Äì5): ${avgUrge}

Top gatilhos:
${topTrig}

Obs.: apoio educacional/comportamental. N√£o substitui acompanhamento profissional.
`;
      downloadText(`relatorio-${currentV}.txt`, txt);
      toast("Relat√≥rio baixado.");
    });

    // =========================
    // ROTAS HASH
    // =========================
    function initRoute(){
      const h = (location.hash || "").replace("#","").trim().toLowerCase();
      if(h && DATA[h]){
        showTrilha(h, false);
      }else{
        viewHome.classList.remove("hidden");
        viewTrilha.classList.add("hidden");
        navLinksHome.classList.remove("hidden");
        navLinksTrilha.classList.add("hidden");
        history.replaceState({view:"home"}, "", "#");
      }
    }

    window.addEventListener("popstate", (e) => {
      if(e.state?.view === "trilha" && e.state?.v){
        showTrilha(e.state.v, false);
      }else{
        showHome(false);
      }
    });

    initRoute();
    updateCheckinUI();
  </script>
</body>
</html>
